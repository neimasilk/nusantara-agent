# Daily Log: 2026-02-09 (Sprint 2 - Stabilization)

**Agent:** Codex (GPT-5)  
**Sprint:** Sprint 2 (Structural)  
**Focus:** Operational hardening untuk mode offline-first + benchmark harian

---

## 1. PROGRESS HARI INI

### Completed Tasks
- [x] Audit blocker benchmark: import `langchain_openai` di level modul membuat pipeline gagal start jika dependency opsional tidak tersedia.
- [x] Implementasi fallback offline pada modul `orchestrator`, `router`, `debate`, `self_correction`, dan `pipeline`.
- [x] Jalankan benchmark ketat manifest: `python experiments/09_ablation_study/run_bench_active.py --strict-manifest`.
- [x] Jalankan regresi test relevan (26 test) untuk modul yang disentuh.

### In Progress
- [ ] Validasi ulang metrik pada mode LLM penuh setelah dependency environment dilengkapi (estimasi 40%).

### Blocked
- [ ] Full deterministic suite lintas semua modul belum bisa hijau karena dependency lokal belum lengkap:
1. `clingo` tidak tersedia.
2. `fitz` (PyMuPDF) tidak tersedia.

---

## 2. METRICS

| Metric | Kemarin | Hari Ini | Delta |
|--------|---------|----------|-------|
| Accuracy | 72.73% (ART-096, mode LLM) | 59.09% (offline fallback) | -13.64% |
| Cases Evaluated | 22 | 22 | 0 |
| Correct | 16 | 13 | -3 |
| Split Skipped | 2 | 2 | 0 |

### Catatan Validitas
- Nilai 59.09% tidak apple-to-apple terhadap 72.73% karena mode eksekusi berbeda.
- Run hari ini menggunakan fallback deterministik akibat dependency LLM/Clingo tidak tersedia di environment.

---

## 3. OBSERVATIONS & INSIGHTS

### What Worked
- Pipeline sekarang tidak crash pada import walau `langchain_openai` tidak terpasang.
- Benchmark bisa dieksekusi end-to-end dalam mode offline-first sesuai kebijakan cost-control.
- Test regresi modul inti yang disentuh lulus penuh: `router`, `nusantara_pipeline`, `debate_json_parser`, `token_usage`.

### What Did Not Work
- Full suite `python -m unittest discover ...` gagal karena dependency sistem (`clingo`, `fitz`) belum ada.
- Akurasi fallback masih di bawah target Sprint 2 (`>=75%`), sehingga belum bisa dijadikan bukti pencapaian milestone metodologis.

### New Insights
- Perlu pemisahan jelas antara:
1. Metrik performa ilmiah (mode LLM + rule engine penuh).
2. Metrik operasional kontingensi (mode fallback).

---

## 4. DECISIONS MADE

| Decision | Rationale | Impact |
|----------|-----------|--------|
| Menambah fallback dependency-optional di modul agent/pipeline | Menjamin benchmark harian tetap berjalan walau environment belum lengkap | Operasional harian unblock, risiko crash turun |
| Menandai hasil 59.09% sebagai metrik fallback, bukan regresi resmi ART-096 | Menjaga integritas evaluasi agar tidak mencampur mode eksekusi berbeda | Dokumentasi lebih jujur dan audit-friendly |
| Menjadikan restorasi dependency lokal sebagai prioritas sebelum evaluasi milestone berikutnya | Target Sprint 2 tidak bisa diverifikasi valid di mode fallback | Menentukan blocker teknis yang konkret |

---

## 5. NEXT STEPS (Tomorrow)

1. Lengkapi dependency lokal (`langchain_openai`, `langgraph`, `clingo`, `pymupdf`) di environment kerja.
2. Re-run full deterministic suite + benchmark aktif pada mode LLM penuh.
3. Bandingkan confusion pattern mode fallback vs mode penuh untuk memisahkan masalah model vs masalah infrastruktur.

---

## 6. RISKS & ISSUES

| Risk/Issue | Severity | Mitigation | Owner |
|------------|----------|------------|-------|
| Drift kesimpulan karena mode fallback dianggap setara mode LLM | High | Label eksplisit semua metrik fallback di log dan report | AI Agent |
| Dependency environment tidak distandardisasi antar mesin/agent | High | Tambah SOP setup terverifikasi sebelum benchmark | Team |
| Overhead koordinasi multi-agent meningkat karena kualitas model berbeda | Medium | Gunakan prompt orchestration berbasis capability-cost | Codex |

---

## 7. ARTIFACTS PRODUCED

- `src/agents/orchestrator.py` (offline-safe orchestrator fallback)
- `src/agents/router.py` (LLM route fallback to heuristic)
- `src/agents/debate.py` (optional dependency guard)
- `src/agents/self_correction.py` (optional dependency guard)
- `src/pipeline/nusantara_agent.py` (clingo fallback + HumanMessage fallback)
- `experiments/09_ablation_study/results_phase1.json` (hasil benchmark run hari ini)

---

## 8. ADDENDUM (Post-Arbiter Finalization, 2026-02-09)

### Data Finalization
- [x] Keputusan arbiter final diterima dari `docs/keputusan_ahli_final.md` untuk 4 kasus tie.
- [x] Vote arbiter diingest melalui `interview_template_arbiter_final_4_tie_2026-02-09.csv`.
- [x] Patch gold label final diterapkan (`CS-LIN-052: D->C`, `CS-LIN-016: C->A`; lainnya tetap).
- [x] Konsistensi internal aktif set: `mismatch gold vs majority = 0`, `SPLIT = 0`.

### Manifest & Benchmark
- [x] Manifest direbuild ke hash terbaru dan lolos validasi (`errors=0`, warning klaim referensi 82 vs aktual 24 tetap ada).
- [x] Benchmark reproducible offline final dijalankan:
  - Command: `NUSANTARA_FORCE_OFFLINE=1 python experiments/09_ablation_study/run_bench_active.py --strict-manifest --output experiments/09_ablation_study/results_post_patch_n24_offline_2026-02-09.json`
  - Hasil: `accuracy=41.67%` (`10/24`), `split_skipped=0`.
  - Catatan: angka ini metrik operasional offline, bukan klaim performa ilmiah final.

### Paper Alignment
- [x] Draft LaTeX diperbarui dengan status pasca-arbiter:
  - tie cases resolved (`0`),
  - distribusi label final (A=7, B=4, C=13, D=0),
  - hasil benchmark offline post-patch + CI.

---

**Log Status:** FINAL  
**Reviewed by:** Pending  
**Handoff needed?** Ya
